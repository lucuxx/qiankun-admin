{"remainingRequest":"/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liuxiang/Desktop/lxx/lxx/blob-server/src/views/edit/index.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"/Users/liuxiang/Desktop/lxx/lxx/blob-server/src/views/edit/index.vue","mtime":1565316969699},{"path":"/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/less-loader/dist/cjs.js","mtime":1562311715001},{"path":"/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n@import '../../assets/css/common.less';\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgUA","file":"index.vue","sourceRoot":"src/views/edit","sourcesContent":["<template>\n    <section class=\"edit\">\n        <el-container style=\"height: 100%\" v-loading=\"loading\" :element-loading-text=\"loadingText\">\n            <el-aside style=\"border-right:1px solid #999999;\" width=\"200px\">\n                <section class=\"AsideNav\">\n                    <ul class=\"article_content\">\n                        <el-collapse v-model=\"activeName\" accordion>\n                            <el-collapse-item :name=\"index\" v-for=\"(item,index) in articleClass\" :key=\"index\">\n                                <template slot=\"title\">\n                                    <div style=\"margin-left: 20px;font-size: 16px\">\n                                        <i class=\"header-icon el-icon-info\"></i>\n                                        <span style=\"display: inline-block;margin-left: 10px\">{{ item.label }}</span>\n                                    </div>\n                                </template>\n                                <div style=\"padding: 0\">\n                                    <li style=\"padding-left:40px;box-sizing: border-box;list-style: none;width: 100%;height: 50px;line-height: 50px;border-bottom: 1px solid #eeeeee;\">\n                                        <el-button type=\"text\"\n                                                   style=\"font-size: 14px;display:inline-block;margin-right: 10px\"\n                                                   @click=\"addArticle\">新建文章\n                                        </el-button>\n                                        <i class=\"el-icon-circle-plus\"></i>\n                                    </li>\n                                    <li style=\"padding-left:40px;box-sizing: border-box;list-style: none;width: 100%;height: 50px;line-height: 50px;border-bottom: 1px solid #eeeeee;\"\n                                        @click=\"changeArticle(i,id)\" v-show=\"item.content && !$lo.isEmpty(item.content)\" v-for=\"(i,id) in item.content\"\n                                        :key=\"id\"\n                                        :class=\"articleIndex === id && activeName === checkActiveName ? 'choiceList' : ''\">\n                                        <el-row style=\"height: 100%;\">\n                                            <el-col class=\"over-flow\" :span=\"18\" style=\"height: 100%;\">\n                                                <el-tooltip class=\"item\" effect=\"dark\" :content=\"i.title\"\n                                                            placement=\"top\">\n                                                    <span>{{ i.title }}</span>\n                                                </el-tooltip>\n                                            </el-col>\n                                            <el-col :span=\"6\" style=\"height: 100%;\">\n                                                <el-dropdown trigger=\"click\" style=\"float: right;margin-right: 10px\">\n                                        <span class=\"el-dropdown-link\">\n                                            <i v-show=\"articleIndex === id\" class=\"el-icon-s-tools\"></i>\n                                        </span>\n                                                    <el-dropdown-menu slot=\"dropdown\">\n                                                        <el-dropdown-item icon=\"el-icon-upload2\">置顶文章</el-dropdown-item>\n                                                        <el-dropdown-item icon=\"el-icon-lock\">设为私密</el-dropdown-item>\n                                                        <el-dropdown-item icon=\"el-icon-delete-solid\"\n                                                                          @click.native=\"deleteArticle(i)\">删除文章\n                                                        </el-dropdown-item>\n                                                        <el-dropdown-item icon=\"el-icon-s-fold\">\n                                                            <el-dropdown>\n                                        <span class=\"el-dropdown-link\">\n                                            <span>设置文章分类</span>\n                                        </span>\n                                                                <el-dropdown-menu slot=\"dropdown\">\n                                                                    <el-dropdown-item v-for=\"(i,id) in articleClass\"\n                                                                                      :key=\"id\"\n                                                                                      :icon=\"i.icon\"\n                                                                                      @click.native=\"changeTabs(i,item)\">\n                                                                        {{ i.label\n                                                                        }}\n                                                                    </el-dropdown-item>\n                                                                </el-dropdown-menu>\n                                                            </el-dropdown>\n                                                        </el-dropdown-item>\n                                                    </el-dropdown-menu>\n                                                </el-dropdown>\n                                            </el-col>\n                                        </el-row>\n                                    </li>\n                                </div>\n                            </el-collapse-item>\n                        </el-collapse>\n                    </ul>\n                </section>\n            </el-aside>\n            <el-container style=\"height: 100%\">\n                <el-header>\n                    <!--                    <articleHeader @changeColor=\"changeColor\" @changeCurrentTitle=\"changeCurrentTitle\"></articleHeader>-->\n                    <section class=\"header\" style=\"height: 100%\">\n                        <el-row style=\"height: 100%;\">\n                            <el-col :span=\"20\" style=\"height: 100%;\">\n                                <label>\n                                    <input class=\"textarea\" :value=\"title\" @change=\"changeCurrentTitle($event)\"/>\n                                </label>\n                            </el-col>\n                            <el-col :span=\"4\" style=\"height: 100%;\">\n                                <div class=\"themes\" @click=\"selectTheme\" style=\"height: 100%;\">\n                                    <span data-theme=\"default\" style=\"width:15px;height:15px\"></span>\n                                    <span data-theme=\"dark\"></span>\n                                    <span data-theme=\"green\"></span>\n                                    <span data-theme=\"gray\"></span>\n                                    <span data-theme=\"princess\"></span>\n                                </div>\n                            </el-col>\n                        </el-row>\n                    </section>\n                </el-header>\n                <el-main style=\"padding: 0;height: 100%;\">\n                    <mark-down\n                            :theme=\"theme\"\n                            :uploadImage=\"uploadImage\"\n                            width=\"100%\"\n                            height=\"100%\"\n                            class=\"markdown\"\n                            @html-change=\"htmlChange\"\n                            :defaultText=\"defaultText\"\n                            @goPublish=\"goPublish\"\n                    />\n                </el-main>\n            </el-container>\n        </el-container>\n    </section>\n</template>\n\n<script lang=\"ts\">\n    import {Vue, Component, Watch} from \"vue-property-decorator\";\n    import \"highlight.js/styles/github.css\";\n    import hljs from \"highlight.js\";\n    import marked from \"marked\";\n    import moment from \"moment\";\n\n    @Component\n    export default class EditNav extends Vue {\n        protected theme: string = \"default\";\n        protected loading: boolean = true;\n        protected currentTitle: string;\n        protected currentHtml: any;\n        protected articleInfo: any = [];\n        protected isPublish: boolean = false;\n        activeName: number = 0;\n        articleIndex: number = 0;\n        protected currentArticle: any = {};\n        protected defaultText: string = \"\";\n        protected title: string = \"文章标题\";\n        protected articleClass: any = [];\n        protected checkActiveName: number = 0;\n\n        // 监听当前文章的变化，获取当前文章的内容和标题\n        @Watch(\"currentArticle\")\n        changeCurrentArticle(val: any) {\n            if (val) {\n                this.title = val.title || \"文章标题\";\n                this.defaultText = val.contentMD || \"## 请选择或者新建文章！\";\n            }\n        }\n\n        // 获取当前加载文本\n        get loadingText(): string {\n            return this.isPublish ? \"文章发布中...\" : \"文章加载中...\";\n        }\n\n        // 拿到所有文章数据存到vuex\n        protected async mounted() {\n            const {data} = (await this.getArticle()).data;\n            this.articleInfo = data;\n            this.getArticleClass();\n            this.currentArticle = this.$lo.find(data, (item: any) => item.tags === \"前端技术\") || [];\n            this.defaultText = this.currentArticle.contentMD || \"## 请选择或者新建文章！\";\n            this.title = this.currentArticle.title || \"文章标题\";\n            this.loading = false;\n        }\n\n        // 切换当前文章\n        protected changeArticle(item: any, id: number): void {\n            this.checkActiveName = this.activeName;\n            this.currentArticle = item;\n            this.articleIndex = id;\n        }\n\n        getArticleClass() {\n            const classArr: Array<Types.ArticleClass> = [\n                {label: \"前端技术\", icon: \"\", content: []},\n                {label: \"生活情感\", icon: \"\", content: []},\n                {label: \"日常吐槽\", icon: \"\", content: []},\n                {label: \"语言艺术\", icon: \"\", content: []},\n            ];\n            if (!this.$lo.isEmpty(this.articleInfo)) {\n                this.$lo.each(this.articleInfo, (item: any) => {\n                    const index = this.$lo.findIndex(classArr, (i: any) => i.label === item.tags);\n                    classArr[index].content.push(item);\n                });\n            }\n            this.articleClass = classArr;\n            console.log(this.articleClass);\n        }\n\n        // 请求文章数据接口\n        async getArticle() {\n            return await this.$api.getArticle();\n        }\n\n        selectTheme(evt: any) {\n            if (evt.target.tagName.toLowerCase() === \"span\") {\n                let theme = evt.target.dataset.theme;\n                let spans = evt.target.parentNode.querySelectorAll(\"span\");\n                for (let i: number = 0; i < spans.length; i++) {\n                    spans[i].style = \"\";\n                }\n                this.theme = theme;\n                evt.target.style.width = \"15px\";\n                evt.target.style.height = \"15px\";\n            }\n        }\n\n        changeCurrentTitle(e: any) {\n            this.currentTitle = e.target.value;\n        }\n\n        // 文章发布\n        protected goPublish() {\n            this.loading = true;\n            this.isPublish = true;\n            marked.setOptions({\n                renderer: new marked.Renderer(),\n                gfm: true,\n                tables: true,\n                breaks: true,\n                pedantic: false,\n                sanitize: false,\n                smartLists: true,\n                smartypants: false\n            });\n            const params = {\n                _id: this.currentArticle._id,\n                title: this.currentTitle,\n                updateTime: moment().format(\"YYYY-MM-DD\"),\n                content: marked(this.currentHtml),\n                contentMD: this.currentHtml,\n                on: true,\n            };\n            // console.log(this.Generate_Brief(this.currentHtml,100));\n            this.$api.updateArticle(params).then((req: any) => {\n                // 增加请求响应时间\n                setTimeout(() => {\n                    this.$message({\n                        type: req.data.code === 0 ? \"success\" : \"error\",\n                        message: req.data.code === 0 ? \"发布成功!\" : \"发布失败!\"\n                    });\n                    this.articleInfo = req.data.data;\n                    this.getArticleClass();\n                    this.currentArticle = this.$lo.find(req.data.data, (item: any) => item._id === this.currentArticle._id);\n                    this.isPublish = false;\n                    this.loading = false;\n                }, 1000);\n            });\n        }\n\n        // 删除文章\n        protected async deleteArticle(article: any) {\n            const {code, data} = (await this.$api.deleteArticle({_id: article._id})).data;\n            this.$message({\n                type: code === 0 ? \"success\" : \"error\",\n                message: data.message\n            });\n            if (code === 0) {\n                console.log(data);\n                this.articleInfo = data.data;\n                this.getArticleClass();\n                this.currentArticle = this.$lo.find(data.data, (item: any) => item.tags === \"前端技术\") || [];\n            }\n        }\n\n        // 添加文章\n        protected addArticle(): void {\n            marked.setOptions({\n                renderer: new marked.Renderer(),\n                gfm: true,\n                tables: true,\n                breaks: true,\n                pedantic: false,\n                sanitize: false,\n                smartLists: true,\n                smartypants: false\n            });\n            const params = {\n                title: moment().format(\"YYYY-MM-DD\") || \"\",\n                time: moment().format(\"YYYY-MM-DD\") || \"\",\n                tags: this.articleClass[this.activeName].label,\n                content: marked(`# ${moment().format(\"YYYY-MM-DD\")}`) || \"\", // 转换过后的html\n                contentMD: `# ${moment().format(\"YYYY-MM-DD\")}` || \"\" // markdown\n            };\n            this.$api.addArticle(params).then(async (req: Types.InterfaceData) => {\n                this.$message({\n                    type: req.data.code === 0 ? \"success\" : \"error\",\n                    message: req.data.data.message\n                });\n                if (req.data.code === 0) {\n                    this.articleInfo = req.data.data.data;\n                    this.getArticleClass();\n                    this.currentArticle = this.$lo.find(req.data.data.data, (item: any) => item.tags === \"前端技术\") || [];\n                }\n            });\n\n        }\n\n        protected async uploadImage(file: any) {\n            return await this.uploadRequest(file);\n        }\n\n        protected changeColor(color: string) {\n            this.theme = color;\n        }\n\n        protected uploadRequest(file: any) {\n            const result = \"https://github.com/luosijie/Front-end-Blog/blob/master/img/logo_vmmarkdown_name.png?raw=true\";\n            return new Promise((resolve, reject) => {\n                window.setTimeout(() => {\n                    resolve(result);\n                }, 1000);\n            });\n        }\n\n        protected htmlChange(html: string) {\n            this.$nextTick(() => {\n                const codes = document.querySelectorAll(\".markdown-body pre code\");\n                codes.forEach(elem => {\n                    hljs.highlightBlock(elem);\n                });\n            });\n            this.currentHtml = html;\n        }\n    }\n</script>\n<style lang=\"less\">\n    @import '../../assets/css/common.less';\n</style>\n<style lang=\"less\" scoped>\n    .edit {\n        width: 100%;\n        height: 100%;\n\n        .AsideNav {\n            .article_content {\n                padding-left: 0;\n                margin-top: 0;\n\n                .article_list {\n                    padding-left: 20px;\n                    box-sizing: border-box;\n                    list-style: none;\n                    width: 100%;\n                    height: 50px;\n                    line-height: 50px;\n                    border-bottom: 1px solid #eeeeee;\n                }\n\n                .choiceList {\n                    background-color: #999999;\n                }\n            }\n        }\n\n        .textarea {\n            height: 100%;\n            color: #666464;\n            width: 80%;\n            outline: none;\n            resize: none;\n            background: transparent;\n            border-color: transparent;\n            font-size: 20px;\n            overflow-y: hidden;\n            overflow-x: hidden\n        }\n\n        .themes {\n            float: right;\n            display: flex;\n            align-items: center;\n            position: relative;\n\n            span {\n                display: inline-block;\n                width: 10px;\n                height: 10px;\n                background-color: red;\n                border-radius: 50%;\n                margin: 0 6px;\n                border: 2px solid #e0e0e0;\n                position: absolute;\n                cursor: pointer;\n                color: white;\n                bottom: 10px;\n\n                &:nth-child(1) {\n                    background-color: #35495e;\n                    right: 120px;\n                }\n\n                &:nth-child(2) {\n                    background-color: #232323;\n                    right: 90px;\n                }\n\n                &:nth-child(3) {\n                    background-color: #41b883;\n                    right: 60px;\n                }\n\n                &:nth-child(4) {\n                    background-color: #fafbfc;\n                    right: 30px;\n                }\n\n                &:nth-child(5) {\n                    background-color: #f05959;\n                    right: 0;\n                }\n            }\n        }\n    }\n\n</style>\n"]}]}