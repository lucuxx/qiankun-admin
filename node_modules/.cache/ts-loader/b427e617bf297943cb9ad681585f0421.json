{"remainingRequest":"/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/babel-loader/lib/index.js!/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/ts-loader/index.js??ref--13-2!/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liuxiang/Desktop/lxx/lxx/blob-server/src/views/edit/index.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/liuxiang/Desktop/lxx/lxx/blob-server/src/views/edit/index.vue","mtime":1565316969699},{"path":"/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.for-each\";\nimport \"core-js/modules/es6.array.find-index\";\nimport \"core-js/modules/es6.array.find\";\nimport \"regenerator-runtime/runtime\";\nimport _createClass from \"/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _inheritsLoose from \"/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/@babel/runtime-corejs2/helpers/esm/inheritsLoose\";\nimport * as tslib_1 from \"tslib\";\nimport { Vue, Component, Watch } from \"vue-property-decorator\";\nimport \"highlight.js/styles/github.css\";\nimport hljs from \"highlight.js\";\nimport marked from \"marked\";\nimport moment from \"moment\";\n\nvar EditNav =\n/*#__PURE__*/\nfunction (_Vue) {\n  _inheritsLoose(EditNav, _Vue);\n\n  function EditNav() {\n    var _this;\n\n    _this = _Vue.apply(this, arguments) || this;\n    _this.theme = \"default\";\n    _this.loading = true;\n    _this.articleInfo = [];\n    _this.isPublish = false;\n    _this.activeName = 0;\n    _this.articleIndex = 0;\n    _this.currentArticle = {};\n    _this.defaultText = \"\";\n    _this.title = \"文章标题\";\n    _this.articleClass = [];\n    _this.checkActiveName = 0;\n    return _this;\n  } // 监听当前文章的变化，获取当前文章的内容和标题\n\n\n  var _proto = EditNav.prototype;\n\n  _proto.changeCurrentArticle = function changeCurrentArticle(val) {\n    if (val) {\n      this.title = val.title || \"文章标题\";\n      this.defaultText = val.contentMD || \"## 请选择或者新建文章！\";\n    }\n  } // 获取当前加载文本\n  ;\n\n  // 拿到所有文章数据存到vuex\n  _proto.mounted = function mounted() {\n    return tslib_1.__awaiter(this, void 0, void 0,\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee() {\n      var data;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return this.getArticle();\n\n            case 2:\n              data = _context.sent.data.data;\n              this.articleInfo = data;\n              this.getArticleClass();\n              this.currentArticle = this.$lo.find(data, function (item) {\n                return item.tags === \"前端技术\";\n              }) || [];\n              this.defaultText = this.currentArticle.contentMD || \"## 请选择或者新建文章！\";\n              this.title = this.currentArticle.title || \"文章标题\";\n              this.loading = false;\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n  } // 切换当前文章\n  ;\n\n  _proto.changeArticle = function changeArticle(item, id) {\n    this.checkActiveName = this.activeName;\n    this.currentArticle = item;\n    this.articleIndex = id;\n  };\n\n  _proto.getArticleClass = function getArticleClass() {\n    var _this2 = this;\n\n    var classArr = [{\n      label: \"前端技术\",\n      icon: \"\",\n      content: []\n    }, {\n      label: \"生活情感\",\n      icon: \"\",\n      content: []\n    }, {\n      label: \"日常吐槽\",\n      icon: \"\",\n      content: []\n    }, {\n      label: \"语言艺术\",\n      icon: \"\",\n      content: []\n    }];\n\n    if (!this.$lo.isEmpty(this.articleInfo)) {\n      this.$lo.each(this.articleInfo, function (item) {\n        var index = _this2.$lo.findIndex(classArr, function (i) {\n          return i.label === item.tags;\n        });\n\n        classArr[index].content.push(item);\n      });\n    }\n\n    this.articleClass = classArr;\n    console.log(this.articleClass);\n  } // 请求文章数据接口\n  ;\n\n  _proto.getArticle = function getArticle() {\n    return tslib_1.__awaiter(this, void 0, void 0,\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee2() {\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return this.$api.getArticle();\n\n            case 2:\n              return _context2.abrupt(\"return\", _context2.sent);\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    }));\n  };\n\n  _proto.selectTheme = function selectTheme(evt) {\n    if (evt.target.tagName.toLowerCase() === \"span\") {\n      var theme = evt.target.dataset.theme;\n      var spans = evt.target.parentNode.querySelectorAll(\"span\");\n\n      for (var i = 0; i < spans.length; i++) {\n        spans[i].style = \"\";\n      }\n\n      this.theme = theme;\n      evt.target.style.width = \"15px\";\n      evt.target.style.height = \"15px\";\n    }\n  };\n\n  _proto.changeCurrentTitle = function changeCurrentTitle(e) {\n    this.currentTitle = e.target.value;\n  } // 文章发布\n  ;\n\n  _proto.goPublish = function goPublish() {\n    var _this3 = this;\n\n    this.loading = true;\n    this.isPublish = true;\n    marked.setOptions({\n      renderer: new marked.Renderer(),\n      gfm: true,\n      tables: true,\n      breaks: true,\n      pedantic: false,\n      sanitize: false,\n      smartLists: true,\n      smartypants: false\n    });\n    var params = {\n      _id: this.currentArticle._id,\n      title: this.currentTitle,\n      updateTime: moment().format(\"YYYY-MM-DD\"),\n      content: marked(this.currentHtml),\n      contentMD: this.currentHtml,\n      on: true\n    }; // console.log(this.Generate_Brief(this.currentHtml,100));\n\n    this.$api.updateArticle(params).then(function (req) {\n      // 增加请求响应时间\n      setTimeout(function () {\n        _this3.$message({\n          type: req.data.code === 0 ? \"success\" : \"error\",\n          message: req.data.code === 0 ? \"发布成功!\" : \"发布失败!\"\n        });\n\n        _this3.articleInfo = req.data.data;\n\n        _this3.getArticleClass();\n\n        _this3.currentArticle = _this3.$lo.find(req.data.data, function (item) {\n          return item._id === _this3.currentArticle._id;\n        });\n        _this3.isPublish = false;\n        _this3.loading = false;\n      }, 1000);\n    });\n  } // 删除文章\n  ;\n\n  _proto.deleteArticle = function deleteArticle(article) {\n    return tslib_1.__awaiter(this, void 0, void 0,\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee3() {\n      var _data, code, data;\n\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return this.$api.deleteArticle({\n                _id: article._id\n              });\n\n            case 2:\n              _data = _context3.sent.data;\n              code = _data.code;\n              data = _data.data;\n              this.$message({\n                type: code === 0 ? \"success\" : \"error\",\n                message: data.message\n              });\n\n              if (code === 0) {\n                console.log(data);\n                this.articleInfo = data.data;\n                this.getArticleClass();\n                this.currentArticle = this.$lo.find(data.data, function (item) {\n                  return item.tags === \"前端技术\";\n                }) || [];\n              }\n\n            case 7:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n  } // 添加文章\n  ;\n\n  _proto.addArticle = function addArticle() {\n    var _this4 = this;\n\n    marked.setOptions({\n      renderer: new marked.Renderer(),\n      gfm: true,\n      tables: true,\n      breaks: true,\n      pedantic: false,\n      sanitize: false,\n      smartLists: true,\n      smartypants: false\n    });\n    var params = {\n      title: moment().format(\"YYYY-MM-DD\") || \"\",\n      time: moment().format(\"YYYY-MM-DD\") || \"\",\n      tags: this.articleClass[this.activeName].label,\n      content: marked(\"# \" + moment().format(\"YYYY-MM-DD\")) || \"\",\n      contentMD: \"# \" + moment().format(\"YYYY-MM-DD\") || \"\" // markdown\n\n    };\n    this.$api.addArticle(params).then(function (req) {\n      return tslib_1.__awaiter(_this4, void 0, void 0,\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee4() {\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                this.$message({\n                  type: req.data.code === 0 ? \"success\" : \"error\",\n                  message: req.data.data.message\n                });\n\n                if (req.data.code === 0) {\n                  this.articleInfo = req.data.data.data;\n                  this.getArticleClass();\n                  this.currentArticle = this.$lo.find(req.data.data.data, function (item) {\n                    return item.tags === \"前端技术\";\n                  }) || [];\n                }\n\n              case 2:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n    });\n  };\n\n  _proto.uploadImage = function uploadImage(file) {\n    return tslib_1.__awaiter(this, void 0, void 0,\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee5() {\n      return regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return this.uploadRequest(file);\n\n            case 2:\n              return _context5.abrupt(\"return\", _context5.sent);\n\n            case 3:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, this);\n    }));\n  };\n\n  _proto.changeColor = function changeColor(color) {\n    this.theme = color;\n  };\n\n  _proto.uploadRequest = function uploadRequest(file) {\n    var result = \"https://github.com/luosijie/Front-end-Blog/blob/master/img/logo_vmmarkdown_name.png?raw=true\";\n    return new Promise(function (resolve, reject) {\n      window.setTimeout(function () {\n        resolve(result);\n      }, 1000);\n    });\n  };\n\n  _proto.htmlChange = function htmlChange(html) {\n    this.$nextTick(function () {\n      var codes = document.querySelectorAll(\".markdown-body pre code\");\n      codes.forEach(function (elem) {\n        hljs.highlightBlock(elem);\n      });\n    });\n    this.currentHtml = html;\n  };\n\n  _createClass(EditNav, [{\n    key: \"loadingText\",\n    get: function get() {\n      return this.isPublish ? \"文章发布中...\" : \"文章加载中...\";\n    }\n  }]);\n\n  return EditNav;\n}(Vue);\n\ntslib_1.__decorate([Watch(\"currentArticle\")], EditNav.prototype, \"changeCurrentArticle\", null);\n\nEditNav = tslib_1.__decorate([Component], EditNav);\nexport default EditNav;",{"version":3,"sources":["/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/liuxiang/Desktop/lxx/lxx/blob-server/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liuxiang/Desktop/lxx/lxx/blob-server/src/views/edit/index.vue?vue&type=script&lang=ts&"],"names":[],"mappings":"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","sourcesContent":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {Vue, Component, Watch} from \"vue-property-decorator\";\nimport \"highlight.js/styles/github.css\";\nimport hljs from \"highlight.js\";\nimport marked from \"marked\";\nimport moment from \"moment\";\n\n@Component\nexport default class EditNav extends Vue {\n    protected theme: string = \"default\";\n    protected loading: boolean = true;\n    protected currentTitle: string;\n    protected currentHtml: any;\n    protected articleInfo: any = [];\n    protected isPublish: boolean = false;\n    activeName: number = 0;\n    articleIndex: number = 0;\n    protected currentArticle: any = {};\n    protected defaultText: string = \"\";\n    protected title: string = \"文章标题\";\n    protected articleClass: any = [];\n    protected checkActiveName: number = 0;\n\n    // 监听当前文章的变化，获取当前文章的内容和标题\n    @Watch(\"currentArticle\")\n    changeCurrentArticle(val: any) {\n        if (val) {\n            this.title = val.title || \"文章标题\";\n            this.defaultText = val.contentMD || \"## 请选择或者新建文章！\";\n        }\n    }\n\n    // 获取当前加载文本\n    get loadingText(): string {\n        return this.isPublish ? \"文章发布中...\" : \"文章加载中...\";\n    }\n\n    // 拿到所有文章数据存到vuex\n    protected async mounted() {\n        const {data} = (await this.getArticle()).data;\n        this.articleInfo = data;\n        this.getArticleClass();\n        this.currentArticle = this.$lo.find(data, (item: any) => item.tags === \"前端技术\") || [];\n        this.defaultText = this.currentArticle.contentMD || \"## 请选择或者新建文章！\";\n        this.title = this.currentArticle.title || \"文章标题\";\n        this.loading = false;\n    }\n\n    // 切换当前文章\n    protected changeArticle(item: any, id: number): void {\n        this.checkActiveName = this.activeName;\n        this.currentArticle = item;\n        this.articleIndex = id;\n    }\n\n    getArticleClass() {\n        const classArr: Array<Types.ArticleClass> = [\n            {label: \"前端技术\", icon: \"\", content: []},\n            {label: \"生活情感\", icon: \"\", content: []},\n            {label: \"日常吐槽\", icon: \"\", content: []},\n            {label: \"语言艺术\", icon: \"\", content: []},\n        ];\n        if (!this.$lo.isEmpty(this.articleInfo)) {\n            this.$lo.each(this.articleInfo, (item: any) => {\n                const index = this.$lo.findIndex(classArr, (i: any) => i.label === item.tags);\n                classArr[index].content.push(item);\n            });\n        }\n        this.articleClass = classArr;\n        console.log(this.articleClass);\n    }\n\n    // 请求文章数据接口\n    async getArticle() {\n        return await this.$api.getArticle();\n    }\n\n    selectTheme(evt: any) {\n        if (evt.target.tagName.toLowerCase() === \"span\") {\n            let theme = evt.target.dataset.theme;\n            let spans = evt.target.parentNode.querySelectorAll(\"span\");\n            for (let i: number = 0; i < spans.length; i++) {\n                spans[i].style = \"\";\n            }\n            this.theme = theme;\n            evt.target.style.width = \"15px\";\n            evt.target.style.height = \"15px\";\n        }\n    }\n\n    changeCurrentTitle(e: any) {\n        this.currentTitle = e.target.value;\n    }\n\n    // 文章发布\n    protected goPublish() {\n        this.loading = true;\n        this.isPublish = true;\n        marked.setOptions({\n            renderer: new marked.Renderer(),\n            gfm: true,\n            tables: true,\n            breaks: true,\n            pedantic: false,\n            sanitize: false,\n            smartLists: true,\n            smartypants: false\n        });\n        const params = {\n            _id: this.currentArticle._id,\n            title: this.currentTitle,\n            updateTime: moment().format(\"YYYY-MM-DD\"),\n            content: marked(this.currentHtml),\n            contentMD: this.currentHtml,\n            on: true,\n        };\n        // console.log(this.Generate_Brief(this.currentHtml,100));\n        this.$api.updateArticle(params).then((req: any) => {\n            // 增加请求响应时间\n            setTimeout(() => {\n                this.$message({\n                    type: req.data.code === 0 ? \"success\" : \"error\",\n                    message: req.data.code === 0 ? \"发布成功!\" : \"发布失败!\"\n                });\n                this.articleInfo = req.data.data;\n                this.getArticleClass();\n                this.currentArticle = this.$lo.find(req.data.data, (item: any) => item._id === this.currentArticle._id);\n                this.isPublish = false;\n                this.loading = false;\n            }, 1000);\n        });\n    }\n\n    // 删除文章\n    protected async deleteArticle(article: any) {\n        const {code, data} = (await this.$api.deleteArticle({_id: article._id})).data;\n        this.$message({\n            type: code === 0 ? \"success\" : \"error\",\n            message: data.message\n        });\n        if (code === 0) {\n            console.log(data);\n            this.articleInfo = data.data;\n            this.getArticleClass();\n            this.currentArticle = this.$lo.find(data.data, (item: any) => item.tags === \"前端技术\") || [];\n        }\n    }\n\n    // 添加文章\n    protected addArticle(): void {\n        marked.setOptions({\n            renderer: new marked.Renderer(),\n            gfm: true,\n            tables: true,\n            breaks: true,\n            pedantic: false,\n            sanitize: false,\n            smartLists: true,\n            smartypants: false\n        });\n        const params = {\n            title: moment().format(\"YYYY-MM-DD\") || \"\",\n            time: moment().format(\"YYYY-MM-DD\") || \"\",\n            tags: this.articleClass[this.activeName].label,\n            content: marked(`# ${moment().format(\"YYYY-MM-DD\")}`) || \"\", // 转换过后的html\n            contentMD: `# ${moment().format(\"YYYY-MM-DD\")}` || \"\" // markdown\n        };\n        this.$api.addArticle(params).then(async (req: Types.InterfaceData) => {\n            this.$message({\n                type: req.data.code === 0 ? \"success\" : \"error\",\n                message: req.data.data.message\n            });\n            if (req.data.code === 0) {\n                this.articleInfo = req.data.data.data;\n                this.getArticleClass();\n                this.currentArticle = this.$lo.find(req.data.data.data, (item: any) => item.tags === \"前端技术\") || [];\n            }\n        });\n\n    }\n\n    protected async uploadImage(file: any) {\n        return await this.uploadRequest(file);\n    }\n\n    protected changeColor(color: string) {\n        this.theme = color;\n    }\n\n    protected uploadRequest(file: any) {\n        const result = \"https://github.com/luosijie/Front-end-Blog/blob/master/img/logo_vmmarkdown_name.png?raw=true\";\n        return new Promise((resolve, reject) => {\n            window.setTimeout(() => {\n                resolve(result);\n            }, 1000);\n        });\n    }\n\n    protected htmlChange(html: string) {\n        this.$nextTick(() => {\n            const codes = document.querySelectorAll(\".markdown-body pre code\");\n            codes.forEach(elem => {\n                hljs.highlightBlock(elem);\n            });\n        });\n        this.currentHtml = html;\n    }\n}\n"],"sourceRoot":""}]}