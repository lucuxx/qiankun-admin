(window["webpackJsonp_sub-admin"]=window["webpackJsonp_sub-admin"]||[]).push([["chunk-57e4e871"],{"1ff9":function(t,e,r){"use strict";var a=r("e77a"),i=r.n(a);i.a},"4bb5":function(t,e,r){"use strict";var a=r("2fe1"),i=r("2f62"),n=(s("computed",i["e"]),s("computed",i["c"])),o=s("methods",i["b"]);s("methods",i["d"]);function s(t,e){function r(r,i){return Object(a["a"])(function(a,n){a[t]||(a[t]={});var o,s=(o={},o[n]=r,o);a[t][n]=void 0!==i?e(i,s)[n]:e(s)[n]})}function i(t,e){if("string"===typeof e){var a=e,i=t;return r(a,void 0)(i,a)}var n=c(e),o=t;return r(o,n)}return i}function c(t){var e=t&&t.namespace;if("string"===typeof e)return"/"!==e[e.length-1]?e+"/":e}r.d(e,"b",function(){return n}),r.d(e,"a",function(){return o})},"5df3":function(t,e,r){"use strict";var a=r("02f4")(!0);r("01f9")(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=a(e,r),this._i+=t.length,{value:t,done:!1})})},"6d67":function(t,e,r){"use strict";var a=r("5ca1"),i=r("0a49")(1);a(a.P+a.F*!r("2f21")([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},7514:function(t,e,r){"use strict";var a=r("5ca1"),i=r("0a49")(5),n="find",o=!0;n in[]&&Array(1)[n](function(){o=!1}),a(a.P+a.F*o,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r("9c6c")(n)},"7f7f":function(t,e,r){var a=r("86cc").f,i=Function.prototype,n=/^\s*function ([^ (]*)/,o="name";o in i||r("9e1e")&&a(i,o,{configurable:!0,get:function(){try{return(""+this).match(n)[1]}catch(t){return""}}})},ba30:function(t,e,r){e=t.exports=r("24fb")(!1),e.push([t.i,".addArticle[data-v-6dd9f21c]{width:95%;margin:0 auto}.addArticle .card .clearfix ul[data-v-6dd9f21c]{width:100%;padding-left:0;height:40px;margin:0}.addArticle .card .clearfix ul li[data-v-6dd9f21c]{color:#000;font-size:18px;list-style:none;float:left;text-align:left;line-height:40px;margin-right:20px;font-weight:600}.avatar-uploader[data-v-6dd9f21c]{width:178px;height:178px;display:block}.avatar-uploader-icon[data-v-6dd9f21c]:hover{border-color:#409eff}.avatar-uploader-icon[data-v-6dd9f21c]{border-radius:6px;font-size:28px;color:#8c939d;width:178px;height:178px;line-height:178px;text-align:center;border:1px dashed #d9d9d9}.avatar[data-v-6dd9f21c]{width:100%;height:100%}",""])},baed:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"addArticle",staticStyle:{"margin-top":"20px"}},[r("el-card",{staticClass:"card",attrs:{"body-style":{padding:"15px",height:"100%",boxSizing:"border-box"}}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("ul",[r("li",[t._v(t._s(t.isAdd?"文章新增":"文章编辑"))])])]),r("div",{staticClass:"card-body"},[r("el-form",{ref:"ruleForm",attrs:{model:t.form,"label-width":"80px",rules:t.rules}},[r("el-form-item",{staticStyle:{height:"130px"},attrs:{label:"封面图片"}},[t.form.img?r("img",{staticStyle:{height:"120px"},attrs:{src:t.form.img,alt:""},on:{click:t.updataImg}}):r("div",{staticStyle:{width:"120px",height:"120px",border:"1px dotted #999999","border-radius":"10px"},on:{click:t.updataImg}},[r("el-icon",{staticClass:"el-icon-plus",staticStyle:{"text-align":"center","line-height":"120px",width:"100%","font-size":"30px"}})],1),r("input",{staticStyle:{width:"0",height:"0"},attrs:{type:"file",id:"file",name:"file"},on:{change:t.handleFile}})]),r("el-form-item",{attrs:{label:"文章标题",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入文章标题"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),r("el-form-item",{attrs:{label:"文章分类"}},[r("el-select",{attrs:{placeholder:"请选择文章分类",prop:"category"},on:{change:t.changeCategory},model:{value:t.form.categoryId,callback:function(e){t.$set(t.form,"categoryId",e)},expression:"form.categoryId"}},t._l(t.classData,function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),r("el-form-item",{attrs:{label:"文章标签"}},[r("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择标签",prop:"tags"},on:{change:t.changeTags},model:{value:t.form.tagId,callback:function(e){t.$set(t.form,"tagId",e)},expression:"form.tagId"}},t._l(t.articleTags,function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),r("el-form-item",{attrs:{label:"文章摘要",prop:"abstract"}},[r("el-input",{attrs:{placeholder:"请输入文章摘要"},model:{value:t.form.abstract,callback:function(e){t.$set(t.form,"abstract",e)},expression:"form.abstract"}})],1),r("el-form-item",{attrs:{label:"文章正文"}},[r("mark-down",{staticClass:"markdown",staticStyle:{height:"500px"},attrs:{theme:t.theme,"default-text":t.form.contentMD,uploadImage:t.uploadImage,width:"100%",height:"100%"},on:{"html-change":t.htmlChange}})],1),r("el-form-item",[t.isAdd?r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSubmit("ruleForm")}}},[t._v("新建")]):r("el-button",{attrs:{type:"primary"},on:{click:t.editArticle}},[t._v("保存")]),r("el-button",{on:{click:t.cancel}},[t._v("取消")])],1)],1)],1)])],1)},i=[],n=(r("28a5"),r("7f7f"),r("7514"),r("6d67"),r("5df3"),r("96cf"),r("ac6a"),r("f3e2"),r("73bc")),o=r("9ab4"),s=r("60a3"),c=r("1487"),l=r.n(c),u=r("0e54"),d=r.n(u),f=r("4bb5"),h=function(t){function e(){var e;return e=t.apply(this,arguments)||this,e.form={img:"",title:"",categoryName:"",categoryId:"",tagName:[],tagId:[],abstract:"",content:"",contentMD:"",id:""},e.classData=[],e.articleTags=[],e.rules={title:[{required:!0,message:"请填写文章标题",trigger:"change"}],category:[{required:!0,message:"请选择文章分类",trigger:"change"}],abstract:[{required:!0,message:"请填写文章摘要",trigger:"change"}],tags:[{required:!0,message:"请选择文章标签",trigger:"change"}]},e.isAdd=!0,e.theme="default",e}Object(n["a"])(e,t);var r=e.prototype;return r.htmlChange=function(t){this.$nextTick(function(){var t=document.querySelectorAll(".markdown-body pre code");t.forEach(function(t){l.a.highlightBlock(t)})}),this.form.contentMD=t,this.form.content=d()(t)},r.mounted=function(){return o["a"](this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,r,a,i,n,o,s,c,l,u,d=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.$route.query,r=e.type,a=e.id,this.articleId=a,this.isAdd="add"===r,!this.isAdd){t.next=13;break}return t.next=6,Promise.all([this.getArticleClass(),this.getArticleTags()]).then(function(t){return d.$lo.map(t,function(t){return d.$util.checkResp(t)})});case 6:i=t.sent,n=i[0],o=i[1],this.classData=n,this.articleTags=o,t.next=22;break;case 13:return t.next=15,Promise.all([this.getArticleClass(),this.getArticleDetails(),this.getArticleTags()]).then(function(t){return d.$lo.map(t,function(t){return d.$util.checkResp(t)})});case 15:s=t.sent,c=s[0],l=s[1],u=s[2],this.classData=c,this.articleTags=u,this.form=l;case 22:case"end":return t.stop()}},t,this)}))},r.editArticle=function(){return o["a"](this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return console.log(this.form),this.form.isUpdate=!0,t.next=4,this.$api.updateArticle(this.form);case 4:e=t.sent,r=e.code,0===r&&this.$router.push({name:"article@index"});case 7:case"end":return t.stop()}},t,this)}))},r.getArticleTags=function(){return this.$api.getArticleTags()},r.changeCategory=function(t){var e=this.$lo.find(this.classData,function(e){return e.id===t}),r=e.name,a=e.id;this.form.categoryName=r,this.form.categoryId=a},r.changeTags=function(t){this.form.tagId=t},r.getArticleDetails=function(){return this.$api.getArticleDetails({id:this.articleId})},r.getArticleClass=function(){return this.$api.getArticleClass()},r.handleFile=function(t){var e=t.target,r=e.files[0],a=r.type.split("/")[0];if("image"==a){var i=Math.round(r.size/1024/1024);if(i>3)this.$message.warning("图片大小不得超过3M");else{var n=new FileReader;n.readAsDataURL(r);var o=this;n.onload=function(){o.form.img=this.result}}}else this.$message.warning("请上传图片")},r.updataImg=function(){var t=document.getElementById("file");t.click()},r.onSubmit=function(t){return o["a"](this,void 0,void 0,regeneratorRuntime.mark(function e(){var r,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(0!==this.$lo.size(this.form.categoryId)){e.next=3;break}return this.$message.warning("请选择文章分类"),e.abrupt("return");case 3:this.form.author=this.userInfo.name||"lxx",r=this.$refs[t],r.validate(function(t){return o["a"](a,void 0,void 0,regeneratorRuntime.mark(function e(){var r,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=8;break}return e.next=3,this.$api.addArticle(this.form);case 3:r=e.sent,a=r.code,0===a&&this.$router.push({name:"article@index"}),e.next=9;break;case 8:return e.abrupt("return",!1);case 9:case"end":return e.stop()}},e,this)}))});case 6:case"end":return e.stop()}},e,this)}))},r.cancel=function(){this.$router.push({name:"article@index"})},r.uploadImage=function(t){return o["a"](this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.uploadRequest(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}))},r.uploadRequest=function(t){var e="https://github.com/luosijie/Front-end-Blog/blob/master/img/logo_vmmarkdown_name.png?raw=true";return new Promise(function(t,r){window.setTimeout(function(){t(e)},1e3)})},e}(s["c"]);o["b"]([f["b"]],h.prototype,"userInfo",void 0),h=o["b"]([s["a"]],h);var g=h,m=g,p=(r("1ff9"),r("2877")),v=Object(p["a"])(m,a,i,!1,null,"6dd9f21c",null);e["default"]=v.exports},e77a:function(t,e,r){var a=r("ba30");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=r("499e").default;i("395a6347",a,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=chunk-57e4e871.ba325f19.js.map