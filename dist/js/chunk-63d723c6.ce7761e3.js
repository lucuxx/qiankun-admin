(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-63d723c6"],{"4bb5":function(t,e,r){"use strict";var i=r("2fe1"),n=r("2f62"),a=(o("computed",n["e"]),o("computed",n["c"])),s=o("methods",n["b"]);o("methods",n["d"]);function o(t,e){function r(r,n){return Object(i["a"])(function(i,a){i[t]||(i[t]={});var s,o=(s={},s[a]=r,s);i[t][a]=void 0!==n?e(n,o)[a]:e(o)[a]})}function n(t,e){if("string"===typeof e){var i=e,n=t;return r(i,void 0)(n,i)}var a=c(e),s=t;return r(s,a)}return n}function c(t){var e=t&&t.namespace;if("string"===typeof e)return"/"!==e[e.length-1]?e+"/":e}r.d(e,"b",function(){return a}),r.d(e,"a",function(){return s})},5846:function(t,e,r){"use strict";var i=r("f9ec"),n=r.n(i);n.a},"5df3":function(t,e,r){"use strict";var i=r("02f4")(!0);r("01f9")(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=i(e,r),this._i+=t.length,{value:t,done:!1})})},"6d67":function(t,e,r){"use strict";var i=r("5ca1"),n=r("0a49")(1);i(i.P+i.F*!r("2f21")([].map,!0),"Array",{map:function(t){return n(this,t,arguments[1])}})},7514:function(t,e,r){"use strict";var i=r("5ca1"),n=r("0a49")(5),a="find",s=!0;a in[]&&Array(1)[a](function(){s=!1}),i(i.P+i.F*s,"Array",{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),r("9c6c")(a)},"7f7f":function(t,e,r){var i=r("86cc").f,n=Function.prototype,a=/^\s*function ([^ (]*)/,s="name";s in n||r("9e1e")&&i(n,s,{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(t){return""}}})},baed:function(t,e,r){"use strict";r.r(e);var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"addArticle",staticStyle:{"margin-top":"80px"}},[r("el-card",{staticClass:"card",attrs:{"body-style":{padding:"15px",height:"100%",boxSizing:"border-box"}}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("ul",[r("li",[t._v(t._s(t.isAdd?"文章新增":"文章编辑"))])])]),r("div",{staticClass:"card-body"},[r("el-form",{ref:"ruleForm",attrs:{model:t.form,"label-width":"80px",rules:t.rules}},[r("el-form-item",{staticStyle:{height:"130px"},attrs:{label:"封面图片"}},[t.form.img?r("img",{staticStyle:{height:"120px"},attrs:{src:t.form.img,alt:""},on:{click:t.updataImg}}):r("div",{staticStyle:{width:"120px",height:"120px",border:"1px dotted #999999","border-radius":"10px"},on:{click:t.updataImg}},[r("el-icon",{staticClass:"el-icon-plus",staticStyle:{"text-align":"center","line-height":"120px",width:"100%","font-size":"30px"}})],1),r("input",{staticStyle:{width:"0",height:"0"},attrs:{type:"file",id:"file",name:"file"},on:{change:t.handleFile}})]),r("el-form-item",{attrs:{label:"文章标题",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入文章标题"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),r("el-form-item",{attrs:{label:"文章分类"}},[r("el-select",{attrs:{placeholder:"请选择文章分类",prop:"category"},on:{change:t.changeCategory},model:{value:t.form.categoryId,callback:function(e){t.$set(t.form,"categoryId",e)},expression:"form.categoryId"}},t._l(t.classData,function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),r("el-form-item",{attrs:{label:"文章标签"}},[r("el-select",{attrs:{multiple:"",filterable:"",placeholder:"请选择标签",prop:"tags"},on:{change:t.changeTags},model:{value:t.form.tagId,callback:function(e){t.$set(t.form,"tagId",e)},expression:"form.tagId"}},t._l(t.articleTags,function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),r("el-form-item",{attrs:{label:"文章摘要",prop:"abstract"}},[r("el-input",{attrs:{placeholder:"请输入文章摘要"},model:{value:t.form.abstract,callback:function(e){t.$set(t.form,"abstract",e)},expression:"form.abstract"}})],1),r("el-form-item",{attrs:{label:"文章正文"}},[r("mark-down",{staticClass:"markdown",staticStyle:{height:"500px"},attrs:{theme:t.theme,"default-text":t.form.contentMD,uploadImage:t.uploadImage,width:"100%",height:"100%"},on:{"html-change":t.htmlChange}})],1),r("el-form-item",[t.isAdd?r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSubmit("ruleForm")}}},[t._v("新建")]):r("el-button",{attrs:{type:"primary"},on:{click:t.editArticle}},[t._v("保存")]),r("el-button",{on:{click:t.cancel}},[t._v("取消")])],1)],1)],1)])],1)},n=[],a=(r("28a5"),r("7f7f"),r("7514"),r("6d67"),r("5df3"),r("96cf"),r("ac6a"),r("f3e2"),r("73bc")),s=r("9ab4"),o=r("60a3"),c=r("1487"),l=r.n(c),u=r("0e54"),d=r.n(u),h=r("4bb5"),f=function(t){function e(){var e;return e=t.apply(this,arguments)||this,e.form={img:"",title:"",categoryName:"",categoryId:"",tagName:[],tagId:[],abstract:"",content:"",contentMD:"",id:""},e.classData=[],e.articleTags=[],e.rules={title:[{required:!0,message:"请填写文章标题",trigger:"change"}],category:[{required:!0,message:"请选择文章分类",trigger:"change"}],abstract:[{required:!0,message:"请填写文章摘要",trigger:"change"}],tags:[{required:!0,message:"请选择文章标签",trigger:"change"}]},e.isAdd=!0,e.theme="default",e}Object(a["a"])(e,t);var r=e.prototype;return r.htmlChange=function(t){this.$nextTick(function(){var t=document.querySelectorAll(".markdown-body pre code");t.forEach(function(t){l.a.highlightBlock(t)})}),this.form.contentMD=t,this.form.content=d()(t)},r.mounted=function(){return s["a"](this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,r,i,n,a,s,o,c,l,u,d=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.$route.query,r=e.type,i=e.id,this.articleId=i,this.isAdd="add"===r,!this.isAdd){t.next=13;break}return t.next=6,Promise.all([this.getArticleClass(),this.getArticleTags()]).then(function(t){return d.$lo.map(t,function(t){return d.$util.checkResp(t)})});case 6:n=t.sent,a=n[0],s=n[1],this.classData=a,this.articleTags=s,t.next=22;break;case 13:return t.next=15,Promise.all([this.getArticleClass(),this.getArticleDetails(),this.getArticleTags()]).then(function(t){return d.$lo.map(t,function(t){return d.$util.checkResp(t)})});case 15:o=t.sent,c=o[0],l=o[1],u=o[2],this.classData=c,this.articleTags=u,this.form=l;case 22:case"end":return t.stop()}},t,this)}))},r.editArticle=function(){return s["a"](this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return console.log(this.form),this.form.isUpdate=!0,t.next=4,this.$api.updateArticle(this.form);case 4:e=t.sent,r=e.code,0===r&&this.$router.push({name:"article@index"});case 7:case"end":return t.stop()}},t,this)}))},r.getArticleTags=function(){return this.$api.getArticleTags()},r.changeCategory=function(t){var e=this.$lo.find(this.classData,function(e){return e.id===t}),r=e.name,i=e.id;this.form.categoryName=r,this.form.categoryId=i},r.changeTags=function(t){this.form.tagId=t},r.getArticleDetails=function(){return this.$api.getArticleDetails({id:this.articleId})},r.getArticleClass=function(){return this.$api.getArticleClass()},r.handleFile=function(t){var e=t.target,r=e.files[0],i=r.type.split("/")[0];if("image"==i){var n=Math.round(r.size/1024/1024);if(n>3)this.$message.warning("图片大小不得超过3M");else{var a=new FileReader;a.readAsDataURL(r);var s=this;a.onload=function(){s.form.img=this.result}}}else this.$message.warning("请上传图片")},r.updataImg=function(){var t=document.getElementById("file");t.click()},r.onSubmit=function(t){return s["a"](this,void 0,void 0,regeneratorRuntime.mark(function e(){var r,i=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(0!==this.$lo.size(this.form.categoryId)){e.next=3;break}return this.$message.warning("请选择文章分类"),e.abrupt("return");case 3:this.form.author=this.userInfo.name||"lxx",r=this.$refs[t],r.validate(function(t){return s["a"](i,void 0,void 0,regeneratorRuntime.mark(function e(){var r,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=8;break}return e.next=3,this.$api.addArticle(this.form);case 3:r=e.sent,i=r.code,0===i&&this.$router.push({name:"article@index"}),e.next=9;break;case 8:return e.abrupt("return",!1);case 9:case"end":return e.stop()}},e,this)}))});case 6:case"end":return e.stop()}},e,this)}))},r.cancel=function(){this.$router.push({name:"article@index"})},r.uploadImage=function(t){return s["a"](this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.uploadRequest(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}))},r.uploadRequest=function(t){var e="https://github.com/luosijie/Front-end-Blog/blob/master/img/logo_vmmarkdown_name.png?raw=true";return new Promise(function(t,r){window.setTimeout(function(){t(e)},1e3)})},e}(o["c"]);s["b"]([h["b"]],f.prototype,"userInfo",void 0),f=s["b"]([o["a"]],f);var m=f,g=m,p=(r("5846"),r("2877")),v=Object(p["a"])(g,i,n,!1,null,"e83b6d44",null);e["default"]=v.exports},f9ec:function(t,e,r){}}]);
//# sourceMappingURL=chunk-63d723c6.ce7761e3.js.map